rediseÃ±o el MVP para depender solo de: âœ… Linear Acceleration + Gyro + Rotation Vector (+ Gravity opcional) + GPS
y NO depender de barÃ³metro.
MVP REDISEÃ‘ADO â€” â€œDH Telemetry (Pocket, No-Barometer)â€
QuÃ© cambia por no tener barÃ³metro
Se elimina:
â€œDescenso continuo detectado por barÃ³metroâ€
â€œPendiente por recorridoâ€
â€œContexto empinado/suaveâ€
Se mantiene (core del producto):
Impactos, vibraciÃ³n (chatter), estabilidad, calidad de aterrizajes
ComparaciÃ³n A/B por recorrido (0â€“100%)
Eventos sobre el recorrido
ValidaciÃ³n del run, pero basada en GPS + continuidad de movimiento (mÃ¡s simple)
1) Sensores usados (final, solo los tuyos)
Principales
TYPE_LINEAR_ACCELERATION (clave): ya viene sin gravedad â†’ perfecto para impactos/vibraciÃ³n
TYPE_GYROSCOPE: estabilidad (pitch/roll/yaw)
TYPE_ROTATION_VECTOR: orientaciÃ³n robusta para alinear ejes (mejor que â€œOrientationâ€ legacy)
Fused Location (GPS): distancia, velocidad, alineaciÃ³n por recorrido
Opcionales (si quieres)
TYPE_GRAVITY: respaldo si Linear Acceleration es ruidoso
TYPE_MAGNETIC_FIELD: solo si necesitas yaw absoluto (no recomendado en DH por interferencias)
No usados en MVP
Contador de pasos
OrientaciÃ³n legacy (se ignora; es obsoleta en Android moderno)
2) Nueva validaciÃ³n de â€œRun vÃ¡lidoâ€ (sin barÃ³metro)
Como ya no puedes confirmar â€œdescensoâ€ fÃ­sicamente, la app valida que el run sea un tramo de movimiento continuo tipo DH:
âœ… Valid run si cumple (valores iniciales sugeridos):
DuraciÃ³n > 30 s
Distancia GPS > 250 m
Tiempo con velocidad > 8 km/h al menos 70% del run
Sin pausas largas: no mÃ¡s de 2 s seguidos con velocidad < 2 km/h (tolerancia configurable)
Calidad GPS: accuracy < 25 m la mayor parte del tiempo (si no, warning)
ğŸ“Œ Para evitar que un â€œliftâ€ pase como run:
En MVP, lo mÃ¡s seguro es Start/Stop manual y â€œeste run es de este tramoâ€.
Puedes aÃ±adir un toggle: â€œEstoy bajando ahoraâ€ (el usuario lo controla).
Mensaje en UI cambia de:
â€œDescenso detectado âœ…â€
a:
â€œMovimiento vÃ¡lido âœ… / Pausas detectadas âš ï¸ / GPS pobre âš ï¸â€
3) MÃ©tricas (actualizadas, sin slope)
A) Impact Score (castigo)
Fuente: Linear Acceleration (ideal)
SeÃ±al base: aLin = (x,y,z) en m/sÂ²
Magnitud: a = sqrt(xÂ²+yÂ²+zÂ²)
Detectar picos: a > Timpact (ej: 12â€“18 m/sÂ²; se calibra)
Debounce: 150 ms
Severidad: sev = peakÂ²
ImpactScore = Î£ sev (normalizado por distancia para comparar)
Serie por recorrido
ImpactDensity(distPct) = sum(sev en ventana) / windowDist
B) Harshness Index (vibraciÃ³n / chatter)
Fuente: Linear Acceleration
Band-pass 15â€“40 Hz (IIR Butterworth)
RMS por ventana (0.5â€“1.0 s)
Resumen:
HarshAvg
HarshP90
Serie por recorrido
Harshness(distPct) = RMS
C) Stability Score (control)
Fuente: Gyroscope
Ï‰ = (Ï‰x, Ï‰y, Ï‰z) rad/s
stabWindow = var(Ï‰x)+var(Ï‰y) o RMS
Resumen:
StabilityScore = mean(stabWindow) (menor = mejor)
(opcional) p90
Serie por recorrido
Stability(distPct)
D) Landing Quality (sin altura)
Fuente: Linear Acceleration
Detectar aterrizaje = impacto grande con firma tÃ­pica:
a > Tlanding (ej: 25â€“35 m/sÂ²)
Debounce 1 s
Calidad:
peak (m/sÂ²)
energy300ms = Î£ aÂ² en 0â€“300 ms
recoveryMs: tiempo hasta volver bajo umbral pequeÃ±o por 200 ms
landingSeverity = w1*peak + w2*sqrt(energy300ms) + w3*recoveryMs
Eventos
LANDING(distPct, severity, meta{peak,energy,recovery})
4) CÃ³mo se usa el Rotation Vector (para mejorar precisiÃ³n)
En bolsillo la orientaciÃ³n cambia. Para no depender de ejes X/Y/Z â€œtal cualâ€, haces esto:
ObtÃ©n matriz de rotaciÃ³n desde TYPE_ROTATION_VECTOR
Rota aLin a un marco â€œearth/bodyâ€ consistente
Calcula componente â€œverticalâ€ estimada o usa magnitud |a| como fallback
MVP simple y robusto:
MÃ©tricas principales con |aLin| (magnitud)
Stability con giroscopio (no requiere orientaciÃ³n absoluta)
Esto evita depender del magnetÃ³metro (que en DH suele ser basura).
5) GPS: uso exacto (sin barÃ³metro)
Se usa para 4 cosas:
Distancia recorrida (para normalizar)
Velocidad (para validar run y detectar pausas)
Alinear runs por recorrido (0â€“100% distPct)
Resampling a un eje comÃºn (N=200 puntos)
No se usa para altura de saltos ni pendientes.
6) Pantallas del MVP (wireframes actualizados)
6.1 Home
Copiar cÃ³digo

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DH Telemetry                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tramo                         â”‚
â”‚ â–¢ Seleccionar tramo           â”‚
â”‚                               â”‚
â”‚ TelÃ©fono                      â”‚
â”‚ â–¢ Bolsillo muslo (default)    â”‚
â”‚                               â”‚
â”‚ Sensores OK                   â”‚
â”‚ â— LinAcc â— Gyro â— RotVec â— GPSâ”‚
â”‚                               â”‚
â”‚ â¬¤ START RUN                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
6.2 Recording (sin â€œdescenso detectadoâ€)
Copiar cÃ³digo

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â— REC      01:12              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SeÃ±al: â— BUENA                â”‚
â”‚ GPS:   â— OK (Â±16 m)           â”‚
â”‚ Movimiento: â— CONTINUO        â”‚
â”‚                               â”‚
â”‚ Impactos (live)   â–“â–“â–“â–‘â–‘       â”‚
â”‚ VibraciÃ³n (live)  â–“â–“â–‘â–‘â–‘       â”‚
â”‚ Estabilidad       â–“â–“â–“â–‘â–‘       â”‚
â”‚                               â”‚
â”‚ â¬¤ STOP                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
6.3 Run Summary
(sin pendiente)
Copiar cÃ³digo

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Run B â€” VÃLIDO                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Tiempo: 2:39     Dist: 1.02km â”‚
â”‚ Vel media: 23 km/h            â”‚
â”‚ Pausas: 0                      â”‚
â”‚                               â”‚
â”‚ â–¢ Impact Score        64      â”‚
â”‚ â–¢ Harshness Avg       0.54    â”‚
â”‚ â–¢ Stability           0.29    â”‚
â”‚ â–¢ Landing Quality     0.48    â”‚
â”‚                               â”‚
â”‚ â¬¤ VER COMPARACIÃ“N             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
6.4 Compare A/B
(igual, solo sin slope context)
Copiar cÃ³digo

Impact  A 86 â†’ B 64   â†“26%
Harsh   A .79â†’ B .54  â†“32%
Stab    A .35â†’ B .29  â†‘17%
Land    A .71â†’ B .48  â†“32%
Tiempo  A 2:42â†’B 2:39 â†“3 s
6.5 Charts (por recorrido)
Quedan 3 curvas + eventos + heatmap:
Impact Density vs distPct
Harshness vs distPct
Stability vs distPct
Eventos sobre distPct
Heatmap lineal (Run A vs Run B)
Se elimina la grÃ¡fica de pendiente.
7) Arquitectura: quÃ© cambia respecto al diseÃ±o anterior
Quitas por completo Barometer y todo lo de â€œslopeâ€.
El mÃ³dulo sensing implementa:
SensorManager para LINEAR_ACCELERATION, GYROSCOPE, ROTATION_VECTOR (y GRAVITY opcional)
FusedLocationProvider para GPS
El mÃ³dulo signal mantiene DSP igual, pero ya no calcula slope.
8) Riesgos al no tener barÃ³metro (y cÃ³mo mitigarlos)
Riesgo: confundir â€œliftâ€ o tramos no-DH como run vÃ¡lido.
MitigaciÃ³n MVP:
Start/Stop manual
ValidaciÃ³n por velocidad/pausas/distancia
Etiquetar runs â€œGPS pobreâ€ como no comparables o comparables con warning
Riesgo: GPS malo en bosque â†’ distPct ruidoso
MitigaciÃ³n:
Resampling por distancia suavizada
Si accuracy > 30â€“50m por mucho tiempo â†’ warning fuerte y/o invalidar
9) QuÃ© le entregas al equipo (cambios concretos)
Remover dependencia de barÃ³metro
Usar TYPE_LINEAR_ACCELERATION como seÃ±al base para impactos/vibraciÃ³n/landing
Usar TYPE_ROTATION_VECTOR solo para estabilizar orientaciÃ³n (opcional en MVP si van con magnitud)
ValidaciÃ³n basada en GPS: distancia/velocidad/pausas/calidad GPS
UI: reemplazar â€œDescenso detectadoâ€ por â€œMovimiento continuo / GPS OKâ€